CONTRACT_TYPE {
	name = SoundingSpec
	group = HistoricalSoundingScience
    sortKey = 994
	
	// ************************ REQUIREMENTS ************************
	REQUIREMENT {
		name = CompleteContract
		type = CompleteContract
		contractType = SoundingRecoverable
		title = Complete @contractType Contract
	}
	REQUIREMENT {
		name = CompleteContract
		type = CompleteContract
		contractType = SoundingThermo
		title = Complete @contractType Contract
		minCount = 3
	}
	
	// ************************ INFORMATION ************************
	title = Launch Campaign: Upper Atmospheric Spectrometry 
	description = Historically, mass spectrometers have been involved in essentially all aspects of space exploration. From the very first Aerobees to the modern day, sounding rockets have been used as a platform to obtain spectrometry above the atmosphere. Get your space spectrometry program underway by launching a sounding rocket with a mass spectrometer and meterological equipment aboard. This is a four-launch science campaign. You will recieve partial rewards for each successful launch.
	genericDescription = Launch four mass spec rockets into space.
	synopsis = This is a four-launch science campaign. Run mass spectrometry with @payload units of meterological monitoring equipment from over @altitude km and recover your payload, four times.
	completedMessage = Well done! The data from this launch campaign has already spawned several scientific papers.

	minExpiry = 0
	maxExpiry = 0
	maxCompletions = 3
	maxSimultaneous = 1
	deadline = 730	
	cooldown = 365
	
	targetBody = HomeWorld()
	
	prestige = Trivial
	genericAdvance = 30
	genericPenalty = 125

	// ************************ COOLDOWNS ************************
	DATA {
		type = float		
		elapsedDays = Round((UniversalTime() - $SoundingSpecCooldown ) / 86400.0)
		amountRecovered = ($SoundingSpecCooldown + 0) == 0 ? 1 : (@elapsedDays - @waitDays) / @expectedDays
	}
	BEHAVIOUR {
		name = SoftCooldownLogCompletionTime
		type = Expression

		CONTRACT_COMPLETED_SUCCESS {
			SoundingSpecCooldown = UniversalTime()
		}
	}
			
	// ************************ DATA ************************
	DATA {
		type = float
		payload = 30
		scienceReward = 2
		altitude = 100
	}
	
	// ************************ PARAMETERS ************************	
	PARAMETER {
		name = MissionParameters
		type = VesselParameterGroup		
		title = @/synopsis
		optional = true

		PARAMETER {
			name = NewVessel
			type = NewVessel
			title = Launch a New Vessel
			hideChildren = true
		}		
		PARAMETER {
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		PARAMETER {
			name = SpaceAltitude
			type = ReachState
			hidden = true
			minAltitude = @/altitude * 1000
			disableOnStateChange = true
			title = Reach an altitude of at least @/altitude km
		}
		PARAMETER {
			name = ExperimentRunning
			type = ExperimentRunning
			title = Perform mass spectroscopy above 100 km
			experiment = RP0massSpec1
			completeInSequence = true
			disableOnStateChange = true
		}
		PARAMETER {
			name = HasMetPayload
			type = HasResource
			resource = MetPayload
			minQuantity = @/payload-0.1
			title = While carrying @/payload units of MetPayload
			hideChildren = true
			completeInSequence = true
			disableOnStateChange = true
		}
		PARAMETER {
			name = ReturnHome
			type = ReturnHome
			targetBody = HomeWorld()
			hidden = true
			hideChildren = true
		}
		PARAMETER {
			name = HasMetPayload2
			type = HasResource
			resource = MetPayload
			minQuantity = @/payload-0.1
			title = Return home safely with the payload
			hideChildren = true
			completeInSequence = true
		}
		PARAMETER { // This is to prevent this guide portion from completing (& thus being hidden) after the first launch
		    name = PlantFlag
		    type = PlantFlag
    		targetBody = Pluto
    		hidden = true
		}
	}

	PARAMETER {
		name = All
		type = All
		title = Launch four successful rockets

		PARAMETER {
			name = MissionParameters
			type = VesselParameterGroup		
			title = First completion

			rewardScience = @/scienceReward
			
			define = SpecSoundingRocket1
			disableOnStateChange = true
			hideChildren = true
		
			PARAMETER {
				name = IsNotVessel1
				type = IsNotVessel
				vessel = SpecSoundingRocket2
			}		
			PARAMETER {
				name = IsNotVessel2
				type = IsNotVessel
				vessel = SpecSoundingRocket3
			}		
			PARAMETER {
				name = IsNotVessel3
				type = IsNotVessel
				vessel = SpecSoundingRocket4
			}
			PARAMETER {
				name = NewVessel
				type = NewVessel
				hideChildren = true
			}		
			PARAMETER {
				name = Crewmembers
				type = HasCrew
				minCrew = 0
				maxCrew = 0
				hideChildren = true
			}
			PARAMETER {
				name = SpaceAltitude
				type = ReachState
				minAltitude = @/altitude * 1000
				hideChildren = true
				disableOnStateChange = true
			}
			PARAMETER {
				name = HasMetPayload
				type = HasResource
				resource = MetPayload
				minQuantity = @/payload-0.1
				hideChildren = true
				completeInSequence = true
				disableOnStateChange = true
			}
			PARAMETER {
				name = ExperimentRunning
				type = ExperimentRunning
				experiment = RP0massSpec1
				completeInSequence = true
				disableOnStateChange = true
				hideChildren = true
			}
			PARAMETER {
				completeInSequence = true
				name = ReturnHome
				type = ReturnHome
				targetBody = HomeWorld()
				hideChildren = true
			}
			PARAMETER {
				name = HasMetPayload2
				type = HasResource
				resource = MetPayload
				minQuantity = @/payload-0.1
				hideChildren = true
				completeInSequence = true
			}
		}

		PARAMETER {
			name = MissionParameters
			type = VesselParameterGroup		
			title = Second completion

			rewardScience = @/scienceReward
			
			define = SpecSoundingRocket2
			disableOnStateChange = true
			hideChildren = true
			completeInSequence = true
		
			PARAMETER {
				name = IsNotVessel1
				type = IsNotVessel
				vessel = SpecSoundingRocket1
			}		
			PARAMETER {
				name = IsNotVessel2
				type = IsNotVessel
				vessel = SpecSoundingRocket3
			}		
			PARAMETER {
				name = IsNotVessel3
				type = IsNotVessel
				vessel = SpecSoundingRocket4
			}
			PARAMETER {
				name = NewVessel
				type = NewVessel
				hideChildren = true
			}		
			PARAMETER {
				name = Crewmembers
				type = HasCrew
				minCrew = 0
				maxCrew = 0
				hideChildren = true
			}
			PARAMETER {
				name = SpaceAltitude
				type = ReachState
				minAltitude = @/altitude * 1000
				hideChildren = true
				disableOnStateChange = true
			}
			PARAMETER {
				name = HasMetPayload
				type = HasResource
				resource = MetPayload
				minQuantity = @/payload-0.1
				hideChildren = true
				completeInSequence = true
				disableOnStateChange = true
			}
			PARAMETER {
				name = ExperimentRunning
				type = ExperimentRunning
				experiment = RP0massSpec1
				completeInSequence = true
				disableOnStateChange = true
				hideChildren = true
			}
			PARAMETER {
				completeInSequence = true
				name = ReturnHome
				type = ReturnHome
				targetBody = HomeWorld()
				hideChildren = true
			}
			PARAMETER {
				name = HasMetPayload2
				type = HasResource
				resource = MetPayload
				minQuantity = @/payload-0.1
				hideChildren = true
				completeInSequence = true
				disableOnStateChange = true
			}
		}

		PARAMETER {
			name = MissionParameters
			type = VesselParameterGroup		
			title = Third completion

			rewardScience = @/scienceReward
			
			define = SpecSoundingRocket3
			disableOnStateChange = true
			hideChildren = true
			completeInSequence = true
		
			PARAMETER {
				name = IsNotVessel1
				type = IsNotVessel
				vessel = SpecSoundingRocket1
			}		
			PARAMETER {
				name = IsNotVessel2
				type = IsNotVessel
				vessel = SpecSoundingRocket2
			}		
			PARAMETER {
				name = IsNotVessel3
				type = IsNotVessel
				vessel = SpecSoundingRocket4
			}
			PARAMETER {
				name = NewVessel
				type = NewVessel
				hideChildren = true
			}		
			PARAMETER {
				name = Crewmembers
				type = HasCrew
				minCrew = 0
				maxCrew = 0
				hideChildren = true
			}
			PARAMETER {
				name = SpaceAltitude
				type = ReachState
				minAltitude = @/altitude * 1000
				hideChildren = true
				disableOnStateChange = true
			}
			PARAMETER {
				name = HasMetPayload
				type = HasResource
				resource = MetPayload
				minQuantity = @/payload-0.1
				hideChildren = true
				completeInSequence = true
				disableOnStateChange = true
			}
			PARAMETER {
				name = ExperimentRunning
				type = ExperimentRunning
				experiment = RP0massSpec1
				completeInSequence = true
				disableOnStateChange = true
				hideChildren = true
			}
			PARAMETER {
				completeInSequence = true
				name = ReturnHome
				type = ReturnHome
				targetBody = HomeWorld()
				hideChildren = true
			}
			PARAMETER {
				name = HasMetPayload2
				type = HasResource
				resource = MetPayload
				minQuantity = @/payload-0.1
				hideChildren = true
				completeInSequence = true
				disableOnStateChange = true
			}
		}

		PARAMETER {
			name = MissionParameters
			type = VesselParameterGroup		
			title = Fourth completion

			rewardScience = @/scienceReward
			
			define = SpecSoundingRocket4
			disableOnStateChange = true
			hideChildren = true
			completeInSequence = true
		
			PARAMETER {
				name = IsNotVessel1
				type = IsNotVessel
				vessel = SpecSoundingRocket1
			}		
			PARAMETER {
				name = IsNotVessel2
				type = IsNotVessel
				vessel = SpecSoundingRocket2
			}		
			PARAMETER {
				name = IsNotVessel3
				type = IsNotVessel
				vessel = SpecSoundingRocket3
			}
			PARAMETER {
				name = NewVessel
				type = NewVessel
				title = Launch a New Vessel
				hideChildren = true
			}		
			PARAMETER {
				name = Crewmembers
				type = HasCrew
				minCrew = 0
				maxCrew = 0
				title = Uncrewed
				hideChildren = true
			}
			PARAMETER {
				name = SpaceAltitude
				type = ReachState
				minAltitude = @/altitude * 1000
				hideChildren = true
				disableOnStateChange = true
			}
			PARAMETER {
				name = HasMetPayload
				type = HasResource
				resource = MetPayload
				minQuantity = @/payload-0.1
				hideChildren = true
				completeInSequence = true
				disableOnStateChange = true
			}
			PARAMETER {
				name = ExperimentRunning
				type = ExperimentRunning
				experiment = RP0massSpec1
				completeInSequence = true
				disableOnStateChange = true
				hideChildren = true
			}
			PARAMETER {
				completeInSequence = true
				name = ReturnHome
				type = ReturnHome
				targetBody = HomeWorld()
				hideChildren = true
			}
			PARAMETER {
				name = HasMetPayload2
				type = HasResource
				resource = MetPayload
				minQuantity = @/payload-0.1
				hideChildren = true
				completeInSequence = true
				disableOnStateChange = true
			}
		}
	}
}
	